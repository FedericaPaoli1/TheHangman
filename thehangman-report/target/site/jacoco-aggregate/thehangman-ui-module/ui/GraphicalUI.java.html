<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>GraphicalUI.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">thehangman-report</a> &gt; <a href="../index.html" class="el_bundle">thehangman-ui-module</a> &gt; <a href="index.source.html" class="el_package">ui</a> &gt; <span class="el_source">GraphicalUI.java</span></div><h1>GraphicalUI.java</h1><pre class="source lang-java linenums">package ui;

import java.awt.Font;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.border.LineBorder;

import exceptions.CharAbsenceException;

import javax.swing.JLabel;
import javax.swing.ImageIcon;
import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Insets;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.BlockingQueue;
import java.util.logging.Logger;

import javax.swing.JButton;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;

import java.awt.Color;

public class GraphicalUI extends JFrame implements UserInterface {

<span class="fc" id="L31">	private static final Logger LOGGER = Logger.getLogger(GraphicalUI.class.getName());</span>
	private static final String DIALOG_FONT = &quot;Dialog&quot;;
	private static final long serialVersionUID = 1L;
	
	private JPanel contentPane;
	private JTextField charTextField;
	private JTextField missesTextField;
	private JLabel lblImage;
	private JLabel[] charLabels;
	private JButton btnTry;
	private JLabel lblMisses;
	private JLabel lblGameResult;
	private int errorCounter;
	private JLabel lblErrorMessage;
<span class="fc" id="L45">	private BlockingQueue&lt;Character&gt; queue = new ArrayBlockingQueue&lt;&gt;(1);</span>

<span class="fc" id="L47">	public GraphicalUI(int guessingWordLength) {</span>
<span class="fc" id="L48">		setTitle(&quot;The Hangman&quot;);</span>
<span class="fc" id="L49">		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="fc" id="L50">		setBounds(100, 100, 950, 638);</span>
<span class="fc" id="L51">		contentPane = new JPanel();</span>
<span class="fc" id="L52">		contentPane.setBackground(Color.WHITE);</span>
<span class="fc" id="L53">		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));</span>
<span class="fc" id="L54">		setContentPane(contentPane);</span>
<span class="fc" id="L55">		GridBagLayout gbl_contentPane = new GridBagLayout();</span>
<span class="fc" id="L56">		gbl_contentPane.columnWidths = new int[] { 92, 180, 62, 62, 0, 40, 25, 12, 28, 0, 0, 0, 0, 0, 0, 22, 0, 0, 0, 0,</span>
				0, 0, 0, 0, 0, 0 };
<span class="fc" id="L58">		gbl_contentPane.rowHeights = new int[] { 17, 297, 0, 72, 49, 13, 39, 42, 39, 0 };</span>
<span class="fc" id="L59">		gbl_contentPane.columnWeights = new double[] { 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,</span>
				0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, Double.MIN_VALUE };
<span class="fc" id="L61">		gbl_contentPane.rowWeights = new double[] { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, Double.MIN_VALUE };</span>
<span class="fc" id="L62">		contentPane.setLayout(gbl_contentPane);</span>

<span class="fc" id="L64">		charLabels = new JLabel[guessingWordLength];</span>
<span class="fc bfc" id="L65" title="All 2 branches covered.">		for (int i = 0; i &lt; charLabels.length; i++) {</span>
<span class="fc" id="L66">			JLabel lblChar = new JLabel(&quot; &quot;);</span>
<span class="fc" id="L67">			lblChar.setName(&quot;finalWordChar&quot; + i);</span>
<span class="fc" id="L68">			lblChar.setFont(new Font(DIALOG_FONT, Font.BOLD, 40));</span>
<span class="fc" id="L69">			lblChar.setForeground(Color.BLACK);</span>
<span class="fc" id="L70">			lblChar.setBackground(new Color(255, 255, 255));</span>
<span class="fc" id="L71">			lblChar.setBorder(new LineBorder(new Color(0, 0, 0), 2));</span>
<span class="fc" id="L72">			GridBagConstraints gbc_lblChar = new GridBagConstraints();</span>
<span class="fc" id="L73">			gbc_lblChar.anchor = GridBagConstraints.EAST;</span>
<span class="fc" id="L74">			gbc_lblChar.insets = new Insets(0, 1, 0, 1);</span>
<span class="fc" id="L75">			gbc_lblChar.gridx = 5 + i;</span>
<span class="fc" id="L76">			gbc_lblChar.gridy = 2;</span>
<span class="fc" id="L77">			contentPane.add(lblChar, gbc_lblChar);</span>
<span class="fc" id="L78">			charLabels[i] = lblChar;</span>
		}

<span class="fc" id="L81">		KeyAdapter btnEnabler = new KeyAdapter() {</span>
			@Override
			public void keyReleased(KeyEvent e) {
<span class="fc bfc" id="L84" title="All 2 branches covered.">				btnTry.setEnabled(!charTextField.getText().trim().isEmpty());</span>
<span class="fc" id="L85">			}</span>
		};

<span class="fc" id="L88">		lblImage = new JLabel(&quot;&quot;);</span>
<span class="fc" id="L89">		lblImage.setName(&quot;image&quot;);</span>
<span class="fc" id="L90">		lblImage.setIcon(new ImageIcon(GraphicalUI.class.getResource(&quot;/images/start.png&quot;)));</span>
<span class="fc" id="L91">		GridBagConstraints gbc_lblImage = new GridBagConstraints();</span>
<span class="fc" id="L92">		gbc_lblImage.fill = GridBagConstraints.VERTICAL;</span>
<span class="fc" id="L93">		gbc_lblImage.gridwidth = 15;</span>
<span class="fc" id="L94">		gbc_lblImage.anchor = GridBagConstraints.WEST;</span>
<span class="fc" id="L95">		gbc_lblImage.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L96">		gbc_lblImage.gridx = 0;</span>
<span class="fc" id="L97">		gbc_lblImage.gridy = 1;</span>
<span class="fc" id="L98">		contentPane.add(lblImage, gbc_lblImage);</span>
		
<span class="fc" id="L100">		lblGameResult = new JLabel(&quot; &quot;);</span>
<span class="fc" id="L101">		lblGameResult.setName(&quot;gameResult&quot;);</span>
<span class="fc" id="L102">		GridBagConstraints gbc_lblNewLabel_1 = new GridBagConstraints();</span>
<span class="fc" id="L103">		gbc_lblNewLabel_1.gridwidth = 10;</span>
<span class="fc" id="L104">		gbc_lblNewLabel_1.fill = GridBagConstraints.VERTICAL;</span>
<span class="fc" id="L105">		gbc_lblNewLabel_1.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L106">		gbc_lblNewLabel_1.gridx = 15;</span>
<span class="fc" id="L107">		gbc_lblNewLabel_1.gridy = 1;</span>
<span class="fc" id="L108">		contentPane.add(lblGameResult, gbc_lblNewLabel_1);</span>

<span class="fc" id="L110">		btnTry = new JButton(&quot;TRY&quot;);</span>
<span class="fc" id="L111">		btnTry.setFont(new Font(DIALOG_FONT, Font.BOLD, 18));</span>
<span class="fc" id="L112">		btnTry.setEnabled(false);</span>
<span class="fc" id="L113">		GridBagConstraints gbc_btnTry = new GridBagConstraints();</span>
<span class="fc" id="L114">		gbc_btnTry.anchor = GridBagConstraints.EAST;</span>
<span class="fc" id="L115">		gbc_btnTry.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L116">		gbc_btnTry.gridx = 1;</span>
<span class="fc" id="L117">		gbc_btnTry.gridy = 4;</span>
<span class="fc" id="L118">		contentPane.add(btnTry, gbc_btnTry);</span>
<span class="fc" id="L119">		btnTry.addActionListener(e -&gt; {</span>
<span class="fc" id="L120">				boolean result = queue.offer(charTextField.getText().toLowerCase().trim().charAt(0));</span>
<span class="fc" id="L121">				this.lblErrorMessage.setText(&quot; &quot;);</span>
<span class="fc" id="L122">				this.charTextField.setText(&quot;&quot;);</span>
<span class="fc" id="L123">				this.btnTry.setEnabled(false);</span>
<span class="fc" id="L124">				LOGGER.info(&quot;Offer result: &quot; + result);</span>
			
<span class="fc" id="L126">		});</span>

<span class="fc" id="L128">		charTextField = new JTextField();</span>
<span class="fc" id="L129">		charTextField.setName(&quot;charTextBox&quot;);</span>
<span class="fc" id="L130">		charTextField.setText(&quot; &quot;);</span>
<span class="fc" id="L131">		GridBagConstraints gbc_charTextField = new GridBagConstraints();</span>
<span class="fc" id="L132">		gbc_charTextField.fill = GridBagConstraints.BOTH;</span>
<span class="fc" id="L133">		gbc_charTextField.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L134">		gbc_charTextField.gridx = 2;</span>
<span class="fc" id="L135">		gbc_charTextField.gridy = 4;</span>
<span class="fc" id="L136">		contentPane.add(charTextField, gbc_charTextField);</span>
<span class="fc" id="L137">		charTextField.setColumns(10);</span>
<span class="fc" id="L138">		charTextField.addKeyListener(btnEnabler);</span>

<span class="fc" id="L140">		lblMisses = new JLabel(&quot;MISSES: &quot;);</span>
<span class="fc" id="L141">		lblMisses.setFont(new Font(DIALOG_FONT, Font.BOLD, 18));</span>
<span class="fc" id="L142">		lblMisses.setName(&quot;misses&quot;);</span>
<span class="fc" id="L143">		GridBagConstraints gbc_lblMisses = new GridBagConstraints();</span>
<span class="fc" id="L144">		gbc_lblMisses.gridwidth = 2;</span>
<span class="fc" id="L145">		gbc_lblMisses.gridheight = 2;</span>
<span class="fc" id="L146">		gbc_lblMisses.anchor = GridBagConstraints.SOUTHEAST;</span>
<span class="fc" id="L147">		gbc_lblMisses.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L148">		gbc_lblMisses.gridx = 0;</span>
<span class="fc" id="L149">		gbc_lblMisses.gridy = 5;</span>
<span class="fc" id="L150">		contentPane.add(lblMisses, gbc_lblMisses);</span>

<span class="fc" id="L152">		missesTextField = new JTextField();</span>
<span class="fc" id="L153">		missesTextField.setFont(new Font(DIALOG_FONT, Font.PLAIN, 15));</span>
<span class="fc" id="L154">		missesTextField.setName(&quot;missesTextBox&quot;);</span>
<span class="fc" id="L155">		missesTextField.setEditable(false);</span>
<span class="fc" id="L156">		missesTextField.setText(&quot;&quot;);</span>
<span class="fc" id="L157">		GridBagConstraints gbc_missesTextField = new GridBagConstraints();</span>
<span class="fc" id="L158">		gbc_missesTextField.gridwidth = 3;</span>
<span class="fc" id="L159">		gbc_missesTextField.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L160">		gbc_missesTextField.fill = GridBagConstraints.BOTH;</span>
<span class="fc" id="L161">		gbc_missesTextField.gridx = 2;</span>
<span class="fc" id="L162">		gbc_missesTextField.gridy = 6;</span>
<span class="fc" id="L163">		contentPane.add(missesTextField, gbc_missesTextField);</span>
<span class="fc" id="L164">		missesTextField.setColumns(10);</span>

<span class="fc" id="L166">		lblErrorMessage = new JLabel(&quot; &quot;);</span>
<span class="fc" id="L167">		lblErrorMessage.setName(&quot;errorMessage&quot;);</span>
<span class="fc" id="L168">		GridBagConstraints gbc_lblErrorMessage = new GridBagConstraints();</span>
<span class="fc" id="L169">		gbc_lblErrorMessage.insets = new Insets(0, 0, 5, 5);</span>
<span class="fc" id="L170">		gbc_lblErrorMessage.gridwidth = 16;</span>
<span class="fc" id="L171">		gbc_lblErrorMessage.gridx = 0;</span>
<span class="fc" id="L172">		gbc_lblErrorMessage.gridy = 7;</span>
<span class="fc" id="L173">		contentPane.add(lblErrorMessage, gbc_lblErrorMessage);</span>

<span class="fc" id="L175">	}</span>

	@Override
	public char getInputChar() {
<span class="fc" id="L179">		return takeElementFromQueue();</span>
	}

	private char takeElementFromQueue() {
<span class="fc" id="L183">		char c = ' ';</span>
		try {
<span class="fc" id="L185">			c = queue.take();</span>
<span class="fc" id="L186">		} catch (InterruptedException e) {</span>
<span class="fc" id="L187">		    Thread.currentThread().interrupt();</span>
<span class="fc" id="L188">		    throw new IllegalStateException(e);</span>
<span class="fc" id="L189">		}</span>
<span class="fc" id="L190">		return c;</span>
	}

	@Override
	public void isGameWon(boolean isWordCompleted) {
<span class="fc bfc" id="L195" title="All 2 branches covered.">		if (!isWordCompleted)</span>
<span class="fc" id="L196">			SwingUtilities</span>
<span class="fc" id="L197">					.invokeLater(() -&gt; lblGameResult.setText(&quot;OH NO! You've finished your remaining attempts =(&quot;));</span>
		else
<span class="fc" id="L199">			SwingUtilities.invokeLater(() -&gt; lblGameResult.setText(&quot;Congratulations! YOU WON =)&quot;));</span>
<span class="fc" id="L200">	}</span>

	@Override
	public void printExceptionMessage(Exception e, char wrongChar) {
<span class="fc" id="L204">		SwingUtilities.invokeLater(() -&gt; lblErrorMessage.setText(e.getMessage()));</span>
<span class="fc bfc" id="L205" title="All 2 branches covered.">		if (e instanceof CharAbsenceException) {</span>
<span class="fc" id="L206">			this.errorCounter++;</span>
<span class="fc" id="L207">			SwingUtilities.invokeLater(() -&gt; missesTextField</span>
<span class="fc" id="L208">					.setText((missesTextField.getText() + &quot; &quot; + Character.toUpperCase(wrongChar))));</span>
<span class="fc" id="L209">			SwingUtilities.invokeLater(() -&gt; lblImage.setIcon(</span>
<span class="fc" id="L210">					new ImageIcon(GraphicalUI.class.getResource(&quot;/images/error_&quot; + this.errorCounter + &quot;.png&quot;))));</span>
		}
<span class="fc" id="L212">	}</span>

	@Override
	public void printGuessingWord(char[] guessingWord) {
<span class="fc" id="L216">		SwingUtilities.invokeLater(() -&gt; {</span>
<span class="fc bfc" id="L217" title="All 2 branches covered.">			for (int i = 0; i &lt; guessingWord.length; i++) {</span>
<span class="fc bfc" id="L218" title="All 2 branches covered.">				if (guessingWord[i] != '_')</span>
<span class="fc" id="L219">					charLabels[i].setText(&quot;&quot; + Character.toUpperCase(guessingWord[i]));</span>
			}
<span class="fc" id="L221">		});</span>
<span class="fc" id="L222">	}</span>

	int getErrorCounter() {
<span class="fc" id="L225">		return this.errorCounter;</span>
	}

	void setErrorCounter(int i) {
<span class="fc" id="L229">		this.errorCounter = i;</span>
<span class="fc" id="L230">	}</span>

	BlockingQueue&lt;Character&gt; getQueue() {
<span class="fc" id="L233">		return this.queue;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>